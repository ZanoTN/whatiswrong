<% if current_user.present? %>
  <header class="navbar navbar-expand-md d-print-none">
    <div class="container-xxl">
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbar-menu"
        aria-controls="navbar-menu"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>


      <%# Navbar Brand / Logo %>
      <%= link_to root_path, class: "navbar-brand me-3 ms-md-0 ms-2" do %>
        <img src="/icon.png" alt="WhatIsWrong" class="navbar-brand-image" style="height: 28px; width: 28px;" />
        <h1 class="my-auto">WhatIsWrong</h1>
      <% end %>

      <%# Navbar user dropdown %>
      <div class="navbar-nav flex-row order-md-last ms-auto">
        <div class="nav-item dropdown">
          <a
            href="#"
            class="nav-link d-flex lh-1 text-reset"
            data-bs-toggle="dropdown"
            aria-label="Open user menu"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-user"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /></svg>
            <div class="d-none d-xl-block ps-2">
              <p class="fw-bold my-auto"><%= current_user.username %></p>
            </div>
          </a>
          <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
            <%= link_to t("custom.navbar.profile"), me_users_path, class: "dropdown-item" %>
            <%= link_to t("custom.navbar.feedback"), "https://github.com/ZanoTN/whatiswrong", class: "dropdown-item", target: "_blank", rel: "noopener" %>
            <%= link_to t("custom.navbar.api_documentation"), api_docs_path, class: "dropdown-item" %>
            <div class="dropdown-divider"></div>
            <%= button_to t("custom.navbar.logout"),
                          destroy_user_session_path,
                          method: :delete,
                          data: { turbo_method: :delete, turbo_confirm: t("custom.navbar.are_you_sure_logout") },
                          class: "dropdown-item text-danger" %>
          </div>
        </div>
      </div>

      <%# Navbar Menu %>
      <div class="collapse navbar-collapse" id="navbar-menu">
        <ul class="navbar-nav">
          <li class="nav-item <%= current_controller_in_url?("messages") ? "active" : "" %>">
            <%= link_to messages_path, class: "nav-link" do %>
              <span class="nav-link-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-message"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 9h8" /><path d="M8 13h6" /><path d="M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z" /></svg>
              </span>
              <span class="nav-link-title"><%= Message.model_name.human(count: 2) %></span>
            <% end %>
          </li>
          <li class="nav-item <%= current_controller_in_url?("apps") ? "active" : "" %>">
            <%= link_to apps_path, class: "nav-link" do %>
              <span class="nav-link-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-sitemap"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M15 15m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z" /><path d="M6 15v-1a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v1" /><path d="M12 9l0 3" /></svg>
              </span>
              <span class="nav-link-title"><%= App.model_name.human(count: 2) %></span>
            <% end %>
          </li>
          <li class="nav-item <%= current_controller_in_url?("settings") ? "active" : "" %>">
            <%= link_to settings_path, class: "nav-link" do %>
              <span class="nav-link-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-settings-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.875 6.27a2.225 2.225 0 0 1 1.125 1.948v7.284c0 .809 -.443 1.555 -1.158 1.948l-6.75 4.27a2.269 2.269 0 0 1 -2.184 0l-6.75 -4.27a2.225 2.225 0 0 1 -1.158 -1.948v-7.285c0 -.809 .443 -1.554 1.158 -1.947l6.75 -3.98a2.33 2.33 0 0 1 2.25 0l6.75 3.98h-.033z" /><path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /></svg>
              </span>
              <span class="nav-link-title"><%= Setting.model_name.human(count: 2) %></span>
            <% end %>
          </li>
        </ul>
      </div>
    </div>
  </header>
<% end %>